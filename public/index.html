<!DOCTYPE html>


<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>
    
      Icebergist -
    
    Icebergist
  </title>
  <meta name="author" content="Orange Iceberg">

  <meta name="description" content="Icebergist is a place where Orange Iceberg team writes about Ruby and Ruby on Rails.">
  

  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href="http://blog.orangeiceberg.com/">
  <link href="http://blog.orangeiceberg.com//favicon.ico" rel="icon">

  
  <link href="http://blog.orangeiceberg.com/index.xml" rel="alternate" title="Icebergist" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="http://blog.orangeiceberg.com//assets/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="http://blog.orangeiceberg.com//assets/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://blog.orangeiceberg.com//assets/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="http://blog.orangeiceberg.com//assets/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://blog.orangeiceberg.com//assets/favicons/favicon-16x16.png">
  <link rel="manifest" href="http://blog.orangeiceberg.com//assets/favicons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="http://blog.orangeiceberg.com//assets/favicons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <script src="http://blog.orangeiceberg.com//js/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="http://blog.orangeiceberg.com//js/octopress.js" type="text/javascript"></script>

  <script src="http://blog.orangeiceberg.com//js/libs/jquery/jquery-2.0.3.min.js"></script>

  <link href="http://blog.orangeiceberg.com//assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="http://blog.orangeiceberg.com//assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
  <link href="http://blog.orangeiceberg.com//css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4735545-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</head>

<body>
  <div id="wrap">
    <header role="banner">
      <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <h1>
              <a href="http://blog.orangeiceberg.com//">Icebergist</a>
              
                <small>Exploring hidden depths of web development</small>
              
            </h1>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="http://feeds.feedburner.com/icebergist" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="http://blog.orangeiceberg.com//images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:http://blog.orangeiceberg.com/">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>

    </header>
    <div id="main" class="container">
      <div id="content">
        
        <div class="row">
          <div class="page-content col-md-9">
            <div class="blog-index">
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Feb 3, 2017</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Jovica Susa</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/introduction-to-ember-closure-actions#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/introduction-to-ember-closure-actions">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/introduction-to-ember-closure-actions">Introduction to Ember Closure Actions</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    

<p>Closure actions were introduced in Ember v.1.13.0 and they brought a lot of improvements over old action handling mechanism in Ember. These improvements enabled Ember to adopt new data flow model called - Data Down Actions Up (DDAU) that simplified communication between parent and child components.</p>

<h2 id="what-are-closure-actions:cd31b1a8953faed5014f17c722aa7ebc">What are closure actions?</h2>

<p>Closure actions are based on JavaScript closures which are basically functions that remember environment in which they were created. So closure actions are just functions that remember context in which they were defined. Since they are just functions we can pass them as a value and call them directly as a callback. This enables us to pass them to inner components and call them directly from components.
With the old approach we had to use <code>sendAction()</code> from component and call action on controller or route.</p>

<h2 id="how-to-create-closure-actions:cd31b1a8953faed5014f17c722aa7ebc">How to create closure actions?</h2>

<p>Every action defined in controller can become a closure action. It’s important to note that it’s possible to make actions defined in routes closure actions but you need to use <a href="https://github.com/DockYard/ember-route-action-helper">ember-route-action-helper</a> addon for that. Closure actions are created in template using <code>action</code> helper which wrapps the action in the current context and returns it as a closure function.</p>

<h2 id="example:cd31b1a8953faed5014f17c722aa7ebc">Example</h2>

<p>Let’s define action inside our application controller.</p>

<pre><code class="language-js">//controllers/application.js
export default Ember.Controller.extend({
  actions: {
    submit() {
      //some logic
    }
  }
});
</code></pre>

<p>In application.hbs we create closure action using <code>action</code> helper and we assign it to example-comp&rsquo;s save attribute.</p>

<pre><code>{{example-comp save=(action 'submit')}}
</code></pre>

<p>Submit action is now assigned to save attribute of example-comp component so we can call it directly inside component.</p>

<pre><code class="language-html">&lt;!-- example-comp.hbs --&gt;

&lt;button onclick={{action 'saveItem'}}&gt;Save&lt;/button&gt;
</code></pre>

<pre><code class="language-js">//example-comp.js
export default Ember.Component.extend({
  actions: {
    saveItem() {
      this.save();
      // Calling save directly
    }
  }
});
</code></pre>

<p>Passing closure action through multiple levels of components is easy.
Let&rsquo;s say we want to call submit action in example-comp-child component. Since we have save attribute inside example-comp with submit action assigned to it we just need to pass it one level down.</p>

<pre><code>{{example-comp-child save=(action save)}}
</code></pre>

<p>Calling action from example-comp-child is the same as for example-comp component.</p>

<pre><code class="language-js">//example-comp-child.js
export default Ember.Component.extend({
  actions: {
    saveItem() {
      this.save();
    }
  }
});
</code></pre>

<p>Closure actions simplify action passing mechanism in Ember but they can also return values, enable currying and much more. It definitely worth spending your time learning all closure actions features and I hope this introduction can help with that.</p>

                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Nov 7, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="https://plus.google.com/113548610124685160907?rel=author">Slobodan Kovačević</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/copy-and-sync-files-from/to-remote-server#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/copy-and-sync-files-from/to-remote-server">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/copy-and-sync-files-from/to-remote-server">Copy and sync files from/to remote server</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>Most modern web app deployments have automated scripts that perform all tasks needed to deploy the app. They handle all the dirty details, while the developer just needs to do something simple like <code>cap deploy</code>. In other words, usually you don&rsquo;t need to access the remote servers directly.</p>

<p>However, sometimes you run into one-time tasks (or less frequent tasks) that might not have been automated. For example, dumping production data and importing on local machine, syncing uploaded files between production and staging environments, etc.</p>

<p>These often involve transferring files between your local machine and remote server (or two remote servers). There are few ways you can handle this depending on what you need to transfer between servers. We are going to cover methods using <code>wget</code>, <code>scp</code>, and <code>rsync</code>.</p>


                     <footer>
                        <a class="btn btn-default" rel="full-article" href="/posts/copy-and-sync-files-from/to-remote-server">Read on &rarr;</a>
                      </footer>
                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Oct 18, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Jovana Dačić</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/backup-and-restore-a-postgresql-database#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/backup-and-restore-a-postgresql-database">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/backup-and-restore-a-postgresql-database">Backup and Restore a PostgreSQL Database</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    

<p>While working on different projects and in different environments, we often need to export a dump from one database and then import it into another. A while ago <a href="http://http://orangeiceberg.com/about/" title="About Slobodan">Slobodan</a> wrote how to <a href="http://icebergist.com/posts/import-and-export-mysql-dump/" title="Import and Export mySQL dump">export and import a mySQL dump</a>, and here is a guide how do it for PostgreSQL.</p>

<h2 id="export-a-postgresql-database-dump:84d8e3d5c8f415260e623e37a1cf3f9b">Export a PostgreSQL database dump</h2>

<p>To export PostgreSQL database we will need to use the <a href="https://www.postgresql.org/docs/current/static/backup-dump.html" title="PostgreSQL">pg_dump</a> tool, which will dump all the contents of a selected database into a single file.
We need to run <code>pg_dump</code> in the command line on the computer where the database is stored. So, if the database is stored on a remote server, you will need to SSH to that server in order to run the following command:</p>

<pre><code>pg_dump -U db_user -W -F t db_name &gt; /path/to/your/file/dump_name.tar
</code></pre>

<p>Here we used the following options:</p>

<ul>
<li><code>-U</code> to specify which user will connect to the PostgreSQL database server.</li>
<li><code>-W</code> or <code>--password</code> will force pg_dump to prompt for a password before connecting to the server.</li>
<li><code>-F</code> is used to specify the format of the output file, which can be one of the following:

<ul>
<li><code>p</code> - plain-text SQL script</li>
<li><code>c</code> - custom-format archive</li>
<li><code>d</code> - directory-format archive</li>
<li><code>t</code> - tar-format archive</li>
</ul></li>
</ul>

<p><sup><em>custom</em>, <em>directory</em> and <em>tar</em> formats are suitable for input into pg_restore.</sup></p>

<p>To see a list of all the available options use <code>pg_dump -?</code>.</p>

<p>With given options <code>pg_dump</code> will first prompt for a password for the database user <code>db_user</code> and then connect as that user to the database named <code>db_name</code>. After it successfully connects, <code>&gt;</code> will write the output produced by pg_dump to a file with a given name, in this case <code>dump_name.tar</code>.</p>

<p>File created in the described process contains all the SQL queries that are required in order to replicate your database.</p>

<h2 id="import-a-postgresql-database-dump:84d8e3d5c8f415260e623e37a1cf3f9b">Import a PostgreSQL database dump</h2>

<p>There are two ways to restore a PostgreSQL database:</p>

<ol>
<li><code>psql</code> for restoring from a plain SQL script file created with <code>pg_dump</code>,</li>
<li><code>pg_restore</code> for restoring from a .tar file, directory, or custom format created with <code>pg_dump</code>.</li>
</ol>

<h3 id="1-restore-a-database-with-psql:84d8e3d5c8f415260e623e37a1cf3f9b">1. Restore a database with psql</h3>

<p>If your backup is a plain-text file containing SQL script, then you can restore your database by using <a href="https://www.postgresql.org/docs/current/static/app-psql.html">PostgreSQL interactive terminal</a>, and running the following command:</p>

<pre><code>psql -U db_user db_name &lt; dump_name.sql
</code></pre>

<p>where <code>db_user</code> is the database user, <code>db_name</code> is the database name, and <code>dump_name.sql</code> is the name of your backup file.</p>

<h3 id="2-restore-a-database-with-pg-restore:84d8e3d5c8f415260e623e37a1cf3f9b">2. Restore a database with pg_restore</h3>

<p>If you choose custom, directory, or archive format when creating a backup file, then you will need to use pg_restore in order to restore your database:</p>

<p><code>pg_restore -d db_name /path/to/your/file/dump_name.tar -c -U db_user</code></p>

<p>If you use pg_restore you have various options available, for example:</p>

<ul>
<li><code>-c</code> to drop database objects before recreating them,</li>
<li><code>-C</code> to create a database before restoring into it,</li>
<li><code>-e</code> exit if an error has encountered,</li>
<li><code>-F format</code> to specify the format of the archive.</li>
</ul>

<p>Use <code>pg_restore -?</code> to get the full list of available options.</p>

<p>You can find more info on using mentioned tools by running <code>man pg_dump</code>, <code>man psql</code> and <code>man pg_restore</code>.</p>

                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Jun 20, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Jovana Dačić</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/using-ransackers-to-search-for-a-key-in-postgresql-json-column#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/using-ransackers-to-search-for-a-key-in-postgresql-json-column">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/using-ransackers-to-search-for-a-key-in-postgresql-json-column">Using Ransackers to search for a key in PostgreSQL JSON column</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>Starting with v9.2, PostgreSQL added native JSON support which enabled us to take advantage of some benefits that come with NoSQL database within a traditional relational database such as PostgreSQL.</p>

<p>While working on a Ruby on Rails application that used PostgreSQL database to store data, we came a across an issue where we needed to implement a search by key within a JSON column.</p>

<p>We were alredy using <a href="https://github.com/activerecord-hackery/ransack">Ransack</a> for building search forms within the application, so we needed a way of telling Ransack to perform a search by given key in our JSON column.</p>

<p>This is where <a href="https://github.com/activerecord-hackery/ransack/wiki/using-ransackers">Ransackers</a> come in.</p>

<blockquote>
<p>The premise behind Ransack is to provide access to Arel predicate methods.</p>
</blockquote>

<p>You can find more information on Arel <a href="https://github.com/rails/arel">here</a>.</p>

<p>In our case we needed to perform a search within <code>transactions</code> table and <code>payload</code> JSON column, looking for records containing a key called <code>invoice_number</code>. To achieve this we added the following ransacker to our <code>Transaction</code> model</p>

<pre><code class="language-ruby">ransacker :invoice_number do |parent|
   Arel::Nodes::InfixOperation.new('-&gt;&gt;', parent.table[:payload], 'invoice_number')
end
</code></pre>

<p>Now with our search set on <code>link_type_cont</code> (cont being just one of Ransack available search predicates), if the user entered for example  <code>123</code> in the search filed, it would generate a query like this:</p>

<pre><code>SELECT  &quot;transactions&quot;.* FROM &quot;transactions&quot;  WHERE (&quot;transactions&quot;.&quot;payload&quot; -&gt;&gt; 'invoice_number' ILIKE '%123%')
</code></pre>

<p>basically performing a search for records in <code>transactions</code> table that have a key called <code>invoice_number</code> with value containing a string <code>123</code>, within a JSON column <code>payload</code>.</p>

                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>May 30, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Ivica Lakatoš</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/show-part-of-a-rails-template-in-other-locale#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/show-part-of-a-rails-template-in-other-locale">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/show-part-of-a-rails-template-in-other-locale">Show part of a Rails template in other locale</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>I recently worked on a Rails project, which had parts of pages in different languages. That may be a problem if you have already translated their entire text to all required languages. You can even be tempted to hardcode parts of the text into other languages. Fortunately, there is an elegant way to solve that problem, just wrap parts of template or partials into blocks with desired locale, like this:</p>

<pre><code class="language-ruby">&lt;% I18n.with_locale('en') do %&gt;
  ...part of your template
  or
  &lt;%= render partial: 'some/partial' %&gt;
&lt;% end %&gt;
</code></pre>

<h3 id="example:87119108ea1faf72eb52a6c753eb4dc7">Example</h3>

<p>Suppose, there is a template with only header and two paragraphs.</p>

<pre><code class="language-html">&lt;h1&gt;&lt;%= t('my_great_header') %&gt;&lt;/h1&gt;

&lt;p&gt;&lt;%= t('first_paragraph') %&gt;&lt;/p&gt;

&lt;p&gt;&lt;%= t('second_paragraph') %&gt;&lt;/p&gt;
</code></pre>

<p>And locale in English and French for that template.</p>

<pre><code># in config/locales/en.yml
en:
  my_great_header: &quot;My English great header&quot;
  first_paragraph: &quot;First English paragraph&quot;
  second_paragraph: &quot;Second English paragraph&quot;

# in config/locales/fr.yml
fr:
  my_great_header: &quot;My French great header&quot;
  first_paragraph: &quot;First French paragraph&quot;
  second_paragraph: &quot;Second French paragraph&quot;
</code></pre>


                     <footer>
                        <a class="btn btn-default" rel="full-article" href="/posts/show-part-of-a-rails-template-in-other-locale">Read on &rarr;</a>
                      </footer>
                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>May 25, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Ivica Lakatoš</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/deploying-rails-app-with-capistrano-3#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/deploying-rails-app-with-capistrano-3">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/deploying-rails-app-with-capistrano-3">Deploying Rails app with Capistrano 3</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>In the lifetime of every application the time comes for it to be presented to everyone. That&rsquo;s why we have to put our application on a special server which is designed for this purpose. In one word, we need to <strong>deploy</strong> our application. In this post you will see how to deploy app with <a href="http://www.capistranorb.com/">Capistrano 3</a>.</p>

<p>Capistrano is a great developers tool that is used to automatically deploy projects to remote server.</p>

<h3 id="add-capistrano-to-rails-app:5a134459841b76e99627f89a0f6507b6">Add Capistrano to Rails app</h3>

<p>I will assume you already have a server set up and an application ready to be deployed remotely.</p>

<p>We will use gem <a href="https://github.com/capistrano/rails">&lsquo;capistrano-rails&rsquo;</a>, so we need to add this gems to Gemfile:</p>

<pre><code class="language-ruby">group :development do
  gem 'capistrano', '~&gt; 3.5'
  gem 'capistrano-rails', '~&gt; 1.1.6'
end
</code></pre>

<p>and install gems with <code>$ bundle install</code>.</p>

<h3 id="initialize-capistrano:5a134459841b76e99627f89a0f6507b6">Initialize Capistrano</h3>

<p>Then run the following command to create configuration files:</p>

<pre><code>$ bundle exec cap install
</code></pre>

<p>This command  creates all the necessary configuration files and directory structure with two stages, staging and production:</p>

<pre><code>Capfile
config/deploy.rb
config/deploy/production.rb
config/deploy/staging.rb
lib/capistrano/tasks
</code></pre>


                     <footer>
                        <a class="btn btn-default" rel="full-article" href="/posts/deploying-rails-app-with-capistrano-3">Read on &rarr;</a>
                      </footer>
                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Mar 24, 2016</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Ivica Lakatoš</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/rake-dbschemaload-vs-rake-dbmigrate#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/rake-dbschemaload-vs-rake-dbmigrate">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/rake-dbschemaload-vs-rake-dbmigrate">rake db:schema:load vs rake db:migrate</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>Sooner or later every new Ruby developer needs to understand  differences between this two common rake tasks. Basically, these simple definition tells us everything we need to know:</p>

<ul>
<li><code>rake db:migrate</code> runs migrations that have not run yet</li>
<li><code>rake db:schema:load</code> loads the schema.db file into database.</li>
</ul>

<p>but the real question is when to use one or the other.</p>

<p><strong>Advice:</strong> <a id="advice"></a> when you are adding a new migration to an existing app then you need to run <code>rake db:migrate</code>, but when you join to existing application (<em>especially some old application</em>), or when you drop your applications database and you need to create it again, always run <code>rake db:schema:load</code> to load schema.</p>

<h3 id="example:bb0863f1c1f426893f44d7c5e616b367">Example</h3>

<p>I am working on application which use <a href="https://github.com/globalize/globalize">globalize gem</a> for ActiveRecord model/data translations. Globalize work this way:</p>

<ul>
<li>first specify attributes which need to be translatable</li>
</ul>

<pre><code class="language-ruby">class Post &lt; ActiveRecord::Base
  translates :title, :text
end
</code></pre>


                     <footer>
                        <a class="btn btn-default" rel="full-article" href="/posts/rake-dbschemaload-vs-rake-dbmigrate">Read on &rarr;</a>
                      </footer>
                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Dec 3, 2015</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="http://orangeiceberg.com/about/">Ivica Lakatoš</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/headless-firefox-in-ubuntu-on-virtualbox-for-cucumber-testing#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/headless-firefox-in-ubuntu-on-virtualbox-for-cucumber-testing">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/headless-firefox-in-ubuntu-on-virtualbox-for-cucumber-testing">Headless Firefox in Ubuntu on VirtualBox for Cucumber testing</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>If you use <a href="http://www.vagrantup.com/downloads.html">Vagrant</a>, <a href="https://www.virtualbox.org/">VirtualBox</a> and Ubuntu to build your Rails apps and you want to test it with Cucumber scenarios, this is the right post for you. By default Vagrant and VirtualBox use Ubuntu without an X server and GUI.</p>

<p>Everything goes well until you need <code>@javascript</code> flag for your cucumber scenario. <code>@javascript</code> uses a javascript-aware system to process web requests (e.g. Selenium) instead of the default (non-javascript-aware) webrat browser.</p>

<h3 id="install-mozilla-firefox:e440c2a4f60085f5f973ab25c52a888b">Install Mozilla Firefox</h3>

<p>Selenium WebDriver is flexible and lets you run selenium headless in servers with no display. But in order to run, Selenium needs to launch a browser. If there is no display to the machine, the browsers are not launched. So in order to use selenium, you need to fake a display and let selenium and the browser think they are running in a machine with a display.</p>

<p>Install latest version of Mozilla Firefox:</p>

<p><code>sudo apt-get install firefox</code></p>

<p>Since Ubuntu is running without a X server Selenium cannot start Firefox because it requires an X server.</p>

<h3 id="setting-up-virtual-x-server:e440c2a4f60085f5f973ab25c52a888b">Setting up virtual X server</h3>

<p>Virtual X server is required to make browsers run normally by making them believe there is a display available, although it doesn&rsquo;t create any visible windows.</p>


                     <footer>
                        <a class="btn btn-default" rel="full-article" href="/posts/headless-firefox-in-ubuntu-on-virtualbox-for-cucumber-testing">Read on &rarr;</a>
                      </footer>
                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Dec 2, 2015</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="https://plus.google.com/113548610124685160907?rel=author">Slobodan Kovačević</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/import-and-export-mysql-dump#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/import-and-export-mysql-dump">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/import-and-export-mysql-dump">Import and export MySQL dump</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>Another simple task that&rsquo;s often hard for beginners is importing and exporting MySQL dumps. Here is quick rundown on how to do it.</p>

<p>To export data you need to use <code>mysqldump</code>:</p>

<pre><code class="language-sh">mysqldump -u db_user -p db_name &gt; dump_name.sql
</code></pre>

<p>Options given to <code>mysqldump</code> are:</p>

<ul>
<li><code>-u db_user</code> - connect as user <code>db_user</code> to database</li>
<li><code>-p</code> - use password, it will ask you to enter your password</li>
<li><code>db_name</code> is the name of MySQL database you want to dump</li>
<li><code>&gt; dump_name.sql</code> - by default <code>mysqldump</code> will print out the dump to terminal, but simple output redirect with <code>&gt;</code> will instead write it to given filename, in this case <code>dump_name.sql</code></li>
</ul>

<p>Now that you have <code>dump_name.sql</code> file with all SQL queries needed to replicate your database you can import it using general-purpose <code>mysql</code> client:</p>

<pre><code class="language-sh">mysql -u db_user -p db_name &lt; dump_name.sql
</code></pre>

<p>User, password, and database name options are the same as for <code>mysqldump</code>. Since <code>mysql</code> reads input from terminal this time we can use <code>&lt;</code> to read input from given file instead.</p>

<p>As always for more information you can consult manual using <code>man mysqldump</code> and <code>man mysql</code>.</p>

                  
                </div>
              </article>
              
              <article class="post">
                <header class="page-header">
                  <p class="meta text-muted">
                    
<span class="glyphicon glyphicon-calendar"></span> <time>Nov 13, 2015</time>


 |
                    <span class="glyphicon glyphicon-user"></span>
<span class="byline author vcard">Posted by
  <span class="fn">
    
      <a href="https://plus.google.com/113548610124685160907?rel=author">Slobodan Kovačević</a>
    
  </span>
</span>
 |

                    <a href="http://blog.orangeiceberg.com/posts/create-and-extract-archives-using-tar-and-gzip#disqus_thread" class="disqus-comment-count" data-disqus-identifier="http://blog.orangeiceberg.com/posts/create-and-extract-archives-using-tar-and-gzip">
                      Comments
                    </a>
                  </p>

                  <h1 class="entry-title">
                    <a href="http://blog.orangeiceberg.com/posts/create-and-extract-archives-using-tar-and-gzip">Create and extract archives using tar and gzip</a>
                  </h1>
                </header>

                <div class="entry-content clearfix">
                  
                    <p>One of the simplest tasks is creating and extracting files using <code>tar</code> and <code>gzip</code>. Yet for most new developers this is a daunting task. These days <code>tar</code> is mostly used to simply combine a few files into a single file and then <code>gzip</code> is used to compress that file.</p>

<p>Here is a quick overview how to use <code>tar</code> and <code>gzip</code> to create and compress an archive:</p>

<pre><code class="language-sh"># archive individual files
tar -cvzf myarchive.tar.gz /path/to/file1 /path/to/file2

# archive whole directory
tar -cvzf myarchive.tar.gz /path/to/dir

# archive whole directory but don't store full path
tar -cvzf myarchive.tar.gz -C /path/to/dir ./
</code></pre>

<p>Options give to tar are: <code>c</code> to create new archive, <code>v</code> to be verbose, <code>z</code> to compress resulting archive with <code>gzip</code>, and <code>f</code> to write the archive to specified file. After options you can list files and dirs you want to archive.</p>

<p>In all examples we provide a full path to a file or dir we want to archive. In this case <code>tar</code> will store files in the archive using the full path. This means once you extract the files you&rsquo;ll have a complete directory structure from root dir onwards.</p>

<p>The way to avoid this is either to manually <code>cd</code> to dir in which files are stored, or to tell <code>tar</code> using <code>C</code> option to change dir before archiving files.</p>

<p>Finally to extract an archive:</p>

<pre><code class="language-sh">tar -xvzf myarchive.tar.gz
</code></pre>

<p>The <code>x</code> option tells <code>tar</code> to extract the archive into current directory.</p>

<p>For more information you can consult manual using <code>man tar</code>.</p>

                  
                </div>
              </article>
              
            </div>

            <ul class="pager">
              
                <li class="previous"><a href="/page/2/">&larr;&nbsp;Older</a></li>
              
              <li><a href="/blog/archives">Blog Archives</a></li>
              
                <li class="next disabled"><a href="#">Newer&nbsp;&rarr;</a></li>
              
            </ul>
          </div>
          <aside class="sidebar col-md-3">
            <section>
  <h2>About us</h2>
  <div>
    <a href="http://orangeiceberg.com">
      <img src="http://orangeiceberg.com/images/oi-logo-footer.png" class="sidebar_avatar" alt="Orange Iceberg web development consultancy" />
    </a>
  </div>
  <div id="sidebar-about">
    <p>
      Hello!
      We are <a href="http://orangeiceberg.com">Orange Iceberg</a> a team of Ruby developers.
    </p>
    <p>
      <strong>Icebergist</strong> is a place where we write about technical challenges we face.
      We build Ruby on Rails web applications, so it's mainly about Ruby and Ruby on Rails.
    </p>
    <p class="hire-us-box">
      <strong>We are available for hire.</strong>
      <br />
      <a href="http://orangeiceberg.com/contact">Find out how we can help you.</a>
    </p>
  </div>
</section>

            <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>

  <div id="recent_posts" class="list-group">
    

    
      
      <a class="list-group-item"
         href="http://blog.orangeiceberg.com/posts/introduction-to-ember-closure-actions">
         Introduction to Ember Closure Actions
      </a>
    
      
      <a class="list-group-item"
         href="http://blog.orangeiceberg.com/posts/copy-and-sync-files-from/to-remote-server">
         Copy and sync files from/to remote server
      </a>
    
      
      <a class="list-group-item"
         href="http://blog.orangeiceberg.com/posts/backup-and-restore-a-postgresql-database">
         Backup and Restore a PostgreSQL Database
      </a>
    
      
      <a class="list-group-item"
         href="http://blog.orangeiceberg.com/posts/using-ransackers-to-search-for-a-key-in-postgresql-json-column">
         Using Ransackers to search for a key in PostgreSQL JSON column
      </a>
    
      
      <a class="list-group-item"
         href="http://blog.orangeiceberg.com/posts/show-part-of-a-rails-template-in-other-locale">
         Show part of a Rails template in other locale
      </a>
    
  </div>

  <div class="panel-heading">
    <a href="/blog/archives/">See more posts</a>
  </div>
</section>

            <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    

    
      
      <a class="list-group-item"
          href="/categories/ruby-and-rails">
          <span class="badge">20</span>Ruby and Rails
      </a>
    
      
      <a class="list-group-item"
          href="/categories/misc">
          <span class="badge">13</span>Misc
      </a>
    
      
      <a class="list-group-item"
          href="/categories/testing">
          <span class="badge">2</span>Testing
      </a>
    
      
      <a class="list-group-item"
          href="/categories/this-should-be-interesting---weekly">
          <span class="badge">2</span>This should be interesting - weekly
      </a>
    
      
      <a class="list-group-item"
          href="/categories/php">
          <span class="badge">1</span>PHP
      </a>
    
      
      <a class="list-group-item"
          href="/categories/javascript">
          <span class="badge">1</span>Javascript
      </a>
    
      
      <a class="list-group-item"
          href="/categories/ember">
          <span class="badge">1</span>Ember
      </a>
    
  </div>
</section>

            <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Tags</h3>
  </div>
  <div class="tag-cloud">
      
      
      
      
      

      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/i18n.locale">I18n.locale</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/javascript">Javascript</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/php">PHP</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/admin">admin</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/amazon-s3">amazon s3</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/apprenticeship">apprenticeship</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/capistrano-3">capistrano 3</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/capistrano-rails">capistrano-rails</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/capistrano-rbenv">capistrano-rbenv</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/carrierwave">carrierwave</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/cloud-computing">cloud computing</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/codeigniter">codeigniter</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/css">css</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/cucumber">cucumber</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/deployment">deployment</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/devise">devise</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/edge">edge</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/ember">ember</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/erkanaauth">erkanaauth</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/factory_girl">factory_girl</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/factorygirl">factorygirl</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/globalize">globalize</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/heroku">heroku</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/hosting">hosting</a>
        </span>
      
        
        
        
        
        

        

        
          
        

        

        

        

        <span class='rank-4'>
          <a href="/tags/howto">howto</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/javascript">javascript</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/links">links</a>
        </span>
      
        
        
        
        
        

        

        
          
        

        

        

        

        <span class='rank-4'>
          <a href="/tags/linux">linux</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/mac">mac</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/mysql">mysql</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/paperclip">paperclip</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/password-protected">password protected</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/postgresql">postgreSQL</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/postgres">postgres</a>
        </span>
      
        
        
        
        
        

        

        

        

        

        
          
        

        <span class='rank-1'>
          <a href="/tags/rails">rails</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/rails3">rails3</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/rails4">rails4</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/rake-task">rake task</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/ransack">ransack</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/resources">resources</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/rest">rest</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/restful">restful</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/rspec">rspec</a>
        </span>
      
        
        
        
        
        

        

        

        

        

        
          
        

        <span class='rank-1'>
          <a href="/tags/ruby">ruby</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/scaffold">scaffold</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/selenium-webdriver">selenium-webdriver</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/sqlite">sqlite</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/tdd">tdd</a>
        </span>
      
        
        
        
        
        

        

        

        
          
        

        

        

        <span class='rank-3'>
          <a href="/tags/tips">tips</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/tutorial">tutorial</a>
        </span>
      
        
        
        
        
        

        

        
          
        

        

        

        

        <span class='rank-4'>
          <a href="/tags/ubuntu">ubuntu</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/vagrant">vagrant</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/virtualbox">virtualbox</a>
        </span>
      
        
        
        
        
        

        
          
        

        

        

        

        

        <span class='rank-5'>
          <a href="/tags/weekly">weekly</a>
        </span>
      
  </div>
</section>

          </aside>
        </div>
        
      </div>
    </div>
  </div>
  <footer role="contentinfo">
    <div class="container">
    <p class="text-muted credits">
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
        <img alt="Creative Commons License" style="border-width:0;float:left;padding-right:5px;" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" />
      </a>
      <span xmlns:dc="http://purl.org/dc/elements/1.1/">icebergist.com</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0 Unported License</a>.

      
      <br />
      <small>
          <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
          <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
      </small>
    </p>
</div>

  </footer>
  <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript" id="dsq-count-scr" src="//icebergist.disqus.com/count.js" async></script>

</body>
</html>
